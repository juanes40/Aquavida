
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="../css/bootstrap.min.css">
	<link rel="stylesheet" href="../css/font-awesome.min.css">
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="../css/pruebaCrear.css">
	<title>Aquavida | Conexion Total 2023</title>


</head>
<body>
	<header>
		<div class="container">
			<div class="row contenedor_logo_menu">
				<div class="logo col-xs-12 col-md-6">
					<a href="index.html"><img src="../img/second (Personalizado).jfif" alt=""></a>
				</div>
				<div class="menu col-xs-12 col-md-6">
					<a href="Usuarios.html">Usuarios</a>
					<a href="#">Estadisticas</a>
					<a href="#">Otros</a>
				</div>
			</div>

                        <!-- ... (código del encabezado) ... -->
            <div class="row formulario">
                <div class="principal col-xs-12 col-md-6">
                    <h2>Edición de Usuario</h2>
                    <form action="../PHP/update_user.php" method="POST">
                        <div class="form-group">
                            <label for="idUsuario">ID del Usuario:</label>
                            <input type="text" class="form-control" id="idUsuario" name="idUsuario" required>
                        </div>
                        <button type="button" id="btnBuscarUsuario" class="btn btn-primary">Buscar Usuario</button>
                        
                        <!-- Mostrar los datos del usuario encontrado -->
                        <div id="datosUsuario" style="display: none;">
                            <div class="form-group">
                                <label for="nombres">Nombres:</label>
                                <input type="text" class="form-control" id="nombres" name="nombres" required>
                            </div>
                            <div class="form-group">
                                <label for="apellidos">Apellidos:</label>
                                <input type="text" class="form-control" id="apellidos" name="apellidos" required>
                            </div>
                            <div class="form-group">
                                <label for="identificacion">Identificación:</label>
                                <input type="text" class="form-control" id="id" name="id" required>
                            </div>
                            <div class="form-group">
                                <label for="usuario">Usuario:</label>
                                <input type="text" class="form-control" id="usuario" name="usuario" required>
                            </div>
                            <div class="form-group">
                                <label for="contraseña">Contraseña:</label>
                                <input type="password" class="form-control" id="contraseña" name="contraseña" required>
                            </div>
                            <button type="submit" id="btnEditarUsuario" class="btn btn-primary">Editar Usuario</button>
                        </div>
                    </form>
                </div>
            </div>

		</div>
		<script>
            window.addEventListener("load", function () {
            document.getElementById("btnBuscarUsuario").addEventListener("click", function (event) {
                var idUsuario = document.getElementById("idUsuario").value;

                // Verificar si el campo idUsuario está vacío
                if (idUsuario.trim() === "") {
                    alert("Por favor, ingrese un ID de usuario.");
                    return; // Salir de la función si el campo está vacío
                }

                // Realiza una solicitud AJAX para obtener los datos del usuario
                var xhr = new XMLHttpRequest();
                xhr.open("POST", "../PHP/consultar_datos_users.php", true);
                xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4) {
                        if (xhr.status === 200) {
                            var respuesta = JSON.parse(xhr.responseText);
                            if (respuesta.error) {
                                // El usuario no fue encontrado, muestra una alerta de error
                                alert(respuesta.error);
                            } else {
                                // Mostrar los datos del usuario encontrado
                                document.getElementById("nombres").value = respuesta.nombres;
                                document.getElementById("apellidos").value = respuesta.apellidos;
                                document.getElementById("id").value = respuesta.id;
                                document.getElementById("usuario").value = respuesta.usuario;
                                document.getElementById("contraseña").value = respuesta.contraseña;

                                // Mostrar el área de datos del usuario
                                document.getElementById("datosUsuario").style.display = "block";
                            }
                        } else {
                            // Error en la solicitud AJAX
                            alert("Error al buscar el usuario");
                        }
                    }
                };
                xhr.send("idUsuario=" + idUsuario);

                // Prevenir el envío del formulario
                event.preventDefault();
            });


    
                document.getElementById("btnEditarUsuario").addEventListener("click", function () {
                    // Validar que los campos estén llenos antes de actualizar
                    var nombres = document.getElementById("nombres").value;
                    var apellidos = document.getElementById("apellidos").value;
                    var identificacion = document.getElementById("id").value;
                    var usuario = document.getElementById("usuario").value;
                    var contraseña = document.getElementById("contraseña").value;
    
                    if (nombres.trim() === "" || apellidos.trim() === "" || identificacion.trim() === "" || usuario.trim() === "" || contraseña.trim() === "") {
                        alert("Por favor, llene todos los campos.");
                    } else {
                        alert("Usuario editado Exitosamente");
                        // Realizar una solicitud AJAX para actualizar los datos
                        var idUsuario = document.getElementById("idUsuario").value;
                        var datosActualizados = {
                            idUsuario: idUsuario,
                            nombres: nombres,
                            apellidos: apellidos,
                            id: id,
                            usuario: usuario,
                            contraseña: contraseña
                            
                        };
    
                        var xhr = new XMLHttpRequest();
                        xhr.open("POST", "../PHP/update_user.php", true);
                        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                        xhr.onreadystatechange = function () {
                            if (xhr.readyState === 4 && xhr.status === 200) {
                                var respuesta = JSON.parse(xhr.responseText);
                                if (respuesta.success) {
                                    alert("Los datos se actualizaron correctamente.");
                                } else {
                                    alert("Error al actualizar los datos.");
                                }
                            }
                        };
                        xhr.send(JSON.stringify(datosActualizados));
                        
                    }
                });
            });
        </script>
        
		
	</header>

	<section class="main">
		<section class="caracteristicas">
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<h3 class="titulo">Características</h3>
					</div>
				</div>

				<div class="row">
					<div class="col-sm-4 caracteristica">
						<img src="../img/icono1.png" alt="" class="icono">
						<h4 class="primera_linea">Estadisticas</h4>
						<p class="parrafo">Dolor sit amet, consectetur adipiscing elit. In dignissim odio ut sagittis elementum.</p>
					</div>
					<div class="col-sm-4 caracteristica">
						<img src="../img/icono2.png" alt="" class="icono">
						<h4 class="primera_linea">Modificaciones manuales</h4>
						<p class="parrafo">Curabitur nisi enim, placerat ac convallis id, posuere vehicula ligula.</p>
					</div>
					<div class="col-sm-4 caracteristica">
						<img src="../img/icono3.png" alt="" class="icono">
						<h4 class="primera_linea">Alarmas</h4>
						<p class="parrafo">Nulla diam mi, pharetra eget mattis sed, mollis non ligula.</p>
					</div>
				</div>
			</div>
		</section>
		
	</section>

</body>
</html>